# Version Management Guide

This project uses `setuptools_scm` for automatic version management based on Git tags.

## How it works

- Version numbers are automatically derived from Git tags
- No need to manually update version strings in code
- Supports semantic versioning (x.y.z)
- Development versions are automatically generated between tags

## Creating a new release

1. **Commit all changes**:
   ```bash
   git add .
   git commit -m "feat: your changes"
   ```

2. **Create a new tag**:
   ```bash
   # Option 1: Using make command
   make tag VERSION=1.2.3
   
   # Option 2: Manual git tag
   git tag -a v1.2.3 -m "Release version 1.2.3"
   ```

3. **Push the tag**:
   ```bash
   git push origin v1.2.3
   ```

## Version formats

- **Release**: `1.2.3` (from tag `v1.2.3`)
- **Development**: `1.2.3.dev5+g1234567` (5 commits after v1.2.3)
- **Dirty working tree**: `1.2.3.dev5+g1234567.d20231215` (with uncommitted changes)

## Checking current version

```bash
# Using setuptools_scm
python -m setuptools_scm

# Using make command
make version

# In Python code
python -c "import src; print(src.__version__)"
```

## Configuration

Version management is configured in `pyproject.toml`:

```toml
[tool.setuptools_scm]
write_to = "src/_version.py"
write_to_template = """
# This file is auto-generated by setuptools_scm
__version__ = "{version}"
__version_tuple__ = {version_tuple}
"""
```

## Best practices

1. **Use semantic versioning**: MAJOR.MINOR.PATCH
   - MAJOR: incompatible API changes
   - MINOR: new functionality, backwards compatible
   - PATCH: bug fixes, backwards compatible

2. **Tag format**: Always use `v` prefix (e.g., `v1.2.3`)

3. **Commit before tagging**: Ensure all changes are committed

4. **Descriptive tag messages**: Include release notes in tag annotations

## Examples

```bash
# Create patch release
make tag VERSION=1.2.4

# Create minor release  
make tag VERSION=1.3.0

# Create major release
make tag VERSION=2.0.0
```

## Integration with CI/CD

The version information can be used in:
- Package building
- Docker image tagging
- Release documentation
- API responses (see `/api` endpoint)